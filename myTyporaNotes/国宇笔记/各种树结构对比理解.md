## 各种树结构对比理解

### **1. 二叉树**

　　二叉树是数据结构中一种重要的数据结构，也是树表家族最为基础的结构。

**二叉树的定义：**

- 二叉树的每个结点至多只有二棵子树(不存在度大于2的结点)
- 二叉树的子树有左右之分，次序不能颠倒
- 二叉树的第i层至多有2^i-1^个结点
- 深度为k的二叉树至多有2^k-1^个结点
- 对任何一棵二叉树T，如果其终端结点数为n~0~，度为2的结点数为n~2~，则n~0~=n~2~+1。

#### 满二叉树

- 除最后一层无任何子节点外，每一层上的所有结点都有两个子结点,除叶子结点外的所有结点均有两个子结点。
- 节点数达到最大值，所有叶子结点必须在同一层上。

　　满二叉树的**性质**：

　　1) 一颗树深度为h，最大层数为k，深度与最大层数相同，k=h;

　　2) 叶子数为2^h^;

　　3) 第k层的结点数是：2^k-1^;

　　4) 总结点数是：2^k^-1,且总节点数一定是奇数。

#### 完全二叉树

若设二叉树的深度为h，除第 h 层外，其它各层 (1～(h-1)层) 的结点数都达到最大个数，第h层所有的结点都连续集中在最左边，这就是完全二叉树。

**注：**完全二叉树是效率很高的数据结构，堆是一种完全二叉树或者近似完全二叉树，所以效率极高，像十分常用的排序算法、Dijkstra算法、Prim算法等都要用堆才能优化，**二叉排序树的效率也要借助平衡性来提高，而平衡性基于完全二叉树**。

![](.\Pic\123.png)

 **二叉树的性质**： 

- 在非空二叉树中，第i层的结点总数不超过2^i-1^, i>=1;
-  深度为h的二叉树最多有2^h^-1个结点(h>=1)，最少有h个结点;
- 对于任意一棵二叉树，如果其叶结点数为N~0~，而度数为2的结点总数为N~2~，则N~0~=N~2~+1;
-  具有n个结点的完全二叉树的深度为log~2~(n+1);
- 有N个结点的完全二叉树各结点如果用顺序方式存储，则结点之间有如下关系
  1. 若i为结点编号则如果i>1，则其父结点的编号为i/2；
  2. 如果2i<=N，则其左儿子(即左子树的根结点)的编号为2i；若2i>N，则无左儿子；
  3. 如果2i+1<=N，则其右儿子的结点编号为2i+1；若2i+1>N，则无右儿子

- 给定N个节点，能构成h(N)种不同的二叉树，其中h(N)为**卡特兰数**的第N项，h(n)=C(2*n, n)/(n+1)
- 设有i个枝点,I为所有枝点的道路长度总和,J为叶的道路长度总和J=I+2i

### 2. **二叉查找树**

**二叉查找树定义**：又称为是二叉排序树（Binary Sort Tree）或二叉搜索树。是数据结构中的一类。在一般情况下，查询效率比链表结构要高。

###### 一棵空树，或者是具有下列性质的二叉树：

- 若左子树不空，则左子树上所有结点的值均小于它的根结点的值；
- 若右子树不空，则右子树上所有结点的值均大于它的根结点的值；
- 左、右子树也分别为二叉排序树；
- 没有键值相等的结点。

**二叉查找树的性质：**对二叉查找树进行**中序遍历**，即可得到有序的数列。

二叉查找树的**时间复杂度**：它和二分查找一样，插入和查找的时间复杂度均为O(logn)，但是在最坏的情况下仍然会有O(n)的时间复杂度。原因在于插入和删除元素的时候，树没有保持平衡。我们追求的是在最坏的情况下仍然有较好的时间复杂度，这就是平衡查找树设计的初衷。

**二叉查找树的高度决定了二叉查找树的查找效率。**

#### 3. 平衡二叉树

　　我们知道，对于一般的二叉搜索树（Binary Search Tree），其期望高度（即为一棵平衡树时）为log2n，其各操作的时间复杂度O(log2n)同时也由此而决定。但是，在某些极端的情况下（如在插入的序列是有序的时），二叉搜索树将退化成近似链或链，此时，其操作的时间复杂度将退化成线性的，即O(n)。我们可以通过随机化建立二叉搜索树来尽量的避免这种情况，但是在进行了多次的操作之后，**由于在删除时，我们总是选择将待删除节点的后继代替它本身，这样就会造成总是右边的节点数目减少，以至于树向左偏沉。**这同时也会造成树的平衡性受到破坏，提高它的操作的时间复杂度。于是就有了我们下边介绍的平衡二叉树。

**平衡二叉树定义：**

- 平衡二叉树（Balanced Binary Tree）又被称为**AVL树**（有别于AVL算法），
- 它是一 棵空树或它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵平衡二叉树。
- 平衡二叉树的常用算法有红黑树、AVL树等。
- 在平衡二叉搜索树中，我们可以看到，其高度一般都良好地维持在O(log~2~n)，大大降低了操作的时间复杂度。

　　最小二叉平衡树的节点的公式如下：

　　F(n)=F(n-1)+F(n-2)+1

　　这个类似于一个递归的数列，可以参考Fibonacci数列，1是根节点，F(n-1)是左子树的节点数量，F(n-2)是右子树的节点数量。

#### 3.1 平衡查找树之AVL树

- AVL树是最先发明的自平衡二叉查找树。AVL树得名于它的发明者 G.M. Adelson-Velsky 和 E.M. Landis，他们在 1962 年的论文 "An algorithm for the organization of information" 中发表了它。
- 在AVL中任何节点的两个儿子子树的高度最大差别为1，所以它也被称为高度平衡树，n个结点的AVL树最大深度约1.44logn。
- 查找、插入和删除在平均和最坏情况下都是O(logn)。增加和删除可能需要通过一次或多次树旋转来重新平衡这个树。
- **这个方案很好的解决了二叉查找树退化成链表的问题，把插入，查找，删除的时间复杂度最好情况和最坏情况都维持在O(logN)。但是频繁旋转会使插入和删除牺牲掉O(logN)左右的时间，不过相对二叉查找树来说，时间上稳定了很多。**

**AVL树的自平衡操作——旋转：**

　　AVL树最关键的也是最难的一步操作就是**旋转**。旋转主要是为了实现AVL树在实施了插入和删除操作以后，树重新回到平衡的方法。下面我们重点研究一下AVL树的旋转。

　　对于一个平衡的节点，由于任意节点最多有两个儿子，因此高度不平衡时，此节点的两颗子树的高度差2.容易看出，这种不平衡出现在下面四种情况：

![](.\Pic\1234.jpg)

1. 6节点的左子树3节点高度比右子树7节点大2，左子树3节点的左子树1节点高度大于右子树4节点，这种情况成为左左。
2. 6节点的左子树2节点高度比右子树7节点大2，左子树2节点的左子树1节点高度小于右子树4节点，这种情况成为左右。
3. 2节点的左子树1节点高度比右子树5节点小2，右子树5节点的左子树3节点高度大于右子树6节点，这种情况成为右左。
4. 2节点的左子树1节点高度比右子树4节点小2，右子树4节点的左子树3节点高度小于右子树6节点，这种情况成为右右。

　　从图2中可以可以看出，1和4两种情况是对称的，这两种情况的旋转算法是一致的，只需要经过一次旋转就可以达到目标，我们称之为**单旋转**。2和3两种情况也是对称的，这两种情况的旋转算法也是一致的，需要进行两次旋转，我们称之为**双旋转**。

**单旋转：**

![](.\Pic\avltree35.jpg)

**右旋转**：

![](.\Pic\12345.jpg)

#### 3.2 平衡二叉树之红黑树

 	**红黑树的定义：**红黑树是一种自平衡二叉查找树，是在计算机科学中用到的一种数据结构，典型的用途是实现**关联数组**。它是在1972年由鲁道夫·贝尔发明的，称之为"对称二叉B树"，它现代的名字是在 Leo J. Guibas 和 Robert Sedgewick 于1978年写的一篇论文中获得的。**它是复杂的，但它的操作有着良好的最坏情况运行时间，并且在实践中是高效的: 它可以在O(logn)时间内做查找，插入和删除，这里的n是树中元素的数目。** 

 	红黑树和AVL树一样都对插入时间、删除时间和查找时间提供了最好可能的最坏情况担保。这不只是使它们在时间敏感的应用如实时应用（real time application）中有价值，而且使它们有在提供最坏情况担保的其他数据结构中作为建造板块的价值；例如，在计算几何中使用的很多数据结构都可以基于红黑树。此外，红黑树还是2-3-4树的一种等同，它们的思想是一样的，只不过红黑树是2-3-4树用二叉树的形式表示的。 

红黑树是一种含有红黑结点并能自平衡的二叉查找树。它必须满足下面**性质**：

- 性质1：每个节点要么是黑色，要么是红色。
- 性质2：根节点是黑色。
- 性质3：每个叶子节点（NIL）是黑色。
- 性质4：每个红色结点的两个子结点一定都是黑色。
- **性质5：任意一结点到每个叶子结点的路径都包含数量相同的黑结点。**

![](.\Pic\redblack.png)

 　这些约束确保了红黑树的关键特性: **从根到叶子的最长的可能路径不多于最短的可能路径的两倍长**。结果是这个树大致上是平衡的。因为操作比如插入、删除和查找某个值的最坏情况时间都要求与树的高度成比例，这个在高度上的理论上限允许红黑树在最坏情况下都是高效的，而不同于普通的二叉查找树。 

 	要知道为什么这些性质确保了这个结果，注意到性质4导致了路径不能有两个毗连的红色节点就足够了。最短的可能路径都是黑色节点，最长的可能路径有交替的红色和黑色节点。因为根据性质5所有最长的路径都有相同数目的黑色节点，这就表明了没有路径能多于任何其他路径的两倍长。 

### **4. B树**

　　B树也是一种用于查找的平衡树，但是它不是二叉树。

**B树的定义：**

- B树（B-tree）是一种树状数据结构，能够用来存储排序后的数据。
- 这种数据结构能够让查找数据、循序存取、插入数据及删除的动作，都在对数时间内完成。
- B树，概括来说是一个一般化的二叉查找树，可以拥有多于2个子节点。与自平衡二叉查找树不同，B-树为系统最优化大块数据的读和写操作。B-tree算法减少定位记录时所经历的中间过程，从而加快存取速度。
- 这种数据结构常被应用在**数据库和文件系统**的实作上。

　　在B树中查找给定关键字的方法是，首先把根结点取来，在根结点所包含的关键字K1,…,Kn查找给定的关键字（可用顺序查找或二分查找法），若找到等于给定值的关键字，则查找成功；否则，一定可以确定要查找的关键字在Ki与Ki+1之间，Pi为指向子树根节点的指针，此时取指针Pi所指的结点继续查找，直至找到，或指针Pi为空时查找失败。

### **5. B+树**

　　B+树是B树的变体，也是一种多路搜索树：

1. 其定义基本与B-树相同，除了：
2. 非叶子结点的子树指针与关键字个数相同；
3. 非叶子结点的子树指针P[i]，指向关键字值属于[K[i], K[i+1])的子树（B-树是开区间）；
4. 为所有叶子结点增加一个链指针；
5.  所有关键字都在叶子结点出现；

B+树的搜索与B树也基本相同，区别是B+树只有达到叶子结点才命中（B树可以在非叶子结点命中），其性能也等价于在关键字全集做一次二分查找； 

**B+的性质：**

- 所有关键字都出现在叶子结点的链表中（稠密索引），且链表中的关键字恰好是有序的；
- 不可能在非叶子结点命中；
- 非叶子结点相当于是叶子结点的索引（稀疏索引），叶子结点相当于是存储（关键字）数据的数据层；
- 更适合**文件索引系统**。

### **6. B*树**

　　B*树是B+树的变体，在B+树的非根和非叶子结点再增加指向兄弟的指针，将结点的最低利用率从1/2提高到2/3。

　　B树定义了非叶子结点关键字个数至少为(2/3)M，即块的最低使用率为2/3（代替B+树的1/2）；

　　B+树的分裂：当一个结点满时，分配一个新的结点，并将原结点中1/2的数据复制到新结点，最后在父结点中增加新结点的指针；B+树的分裂只影响原结点和父结点，而不会影响兄弟结点，所以它不需要指向兄弟的指针；

　　B*树的分裂：当一个结点满时，如果它的下一个兄弟结点未满，那么将一部分数据移到兄弟结点中，再在原结点插入关键字，最后修改父结点中兄弟结点的关键字（因为兄弟结点的关键字范围改变了）；如果兄弟也满了，则在原结点与兄弟结点之间增加新结点，并各复制1/3的数据到新结点，最后在父结点增加新结点的指针；

　　所以，B*树分配新结点的概率比B+树要低，空间使用率更高。

### **7. Trie树**

　　Tire树称为字典树，又称单词查找树，Trie树，是一种树形结构，是一种哈希树的变种。典型应用是用于统计，排序和保存大量的字符串（但不仅限于字符串），所以经常被搜索引擎系统用于**文本词频统计**。**它的优点是：利用字符串的公共前缀来减少查询时间，最大限度地减少无谓的字符串比较，查询效率比哈希树高。**

**Tire树的三个基本性质：**

- 根节点不包含字符，除根节点外每一个节点都只包含一个字符；
- 从根节点到某一节点，路径上经过的字符连接起来，为该节点对应的字符串；
- 每个节点的所有子节点包含的字符都不相同。

**Tire树的应用：**

- 串的快速检索

1. 给出N个单词组成的熟词表，以及一篇全用小写英文书写的文章，请你按最早出现的顺序写出所有不在熟词表中的生词。

2. 在这道题中，我们可以用数组枚举，用哈希，用字典树，先把熟词建一棵树，然后读入文章进行比较，这种方法效率是比较高的。

- “串”排序

1. 给定N个互不相同的仅由一个单词构成的英文名，让你将他们按字典序从小到大输出。用字典树进行排序，采用数组的方式创建字典树，这棵树的每个结点的所有儿子很显然地按照其字母大小排序。对这棵树进行先序遍历即可。

-  最长公共前缀

1. 对所有串建立字典树，对于两个串的最长公共前缀的长度即他们所在的结点的公共祖先个数，于是，问题就转化为求公共祖先的问题。

### 计算机科学中的树

| 二叉树 | ▪ [二叉树](http://baike.baidu.com/view/88806.htm)▪ [二叉查找树](http://baike.baidu.com/view/389459.htm)▪ [笛卡尔树](http://baike.baidu.com/view/6667519.htm)▪ [Top tree](http://baike.baidu.com/searchword/?word=Top tree&pic=1&sug=1&enc=utf8)▪ [T树](http://baike.baidu.com/searchword/?word=T树&pic=1&sug=1&enc=utf8) |
| :----: | ------------------------------------------------------------ |
|        |                                                              |

| 自平衡二叉查找树 | ▪ [AA树](http://baike.baidu.com/searchword/?word=AA树&pic=1&sug=1&enc=utf8)▪ [AVL树](http://baike.baidu.com/view/671745.htm)▪ [红黑树](http://baike.baidu.com/view/133754.htm)▪ [伸展树](http://baike.baidu.com/view/1118088.htm)▪ [树堆](http://baike.baidu.com/searchword/?word=树堆&pic=1&sug=1&enc=utf8)▪ [节点大小平衡树](http://baike.baidu.com/searchword/?word=节点大小平衡树&pic=1&sug=1&enc=utf8) |
| :--------------: | ------------------------------------------------------------ |
|                  |                                                              |

| B树  | ▪ [B树](http://baike.baidu.com/view/298408.htm)▪ [B+树](http://baike.baidu.com/view/1168762.htm)▪ [B*树](http://baike.baidu.com/view/1605516.htm)▪ [Bx树](http://baike.baidu.com/searchword/?word=Bx树&pic=1&sug=1&enc=utf8)▪ [UB树](http://baike.baidu.com/searchword/?word=UB树&pic=1&sug=1&enc=utf8)▪ [2-3树](http://baike.baidu.com/view/1668085.htm)▪ **2-3-4树**▪ [(a,b)-树](http://baike.baidu.com/searchword/?word=(a%2Cb)-树&pic=1&sug=1&enc=utf8)▪ [Dancing tree](http://baike.baidu.com/searchword/?word=Dancing tree&pic=1&sug=1&enc=utf8)▪ [H树](http://baike.baidu.com/searchword/?word=H树&pic=1&sug=1&enc=utf8) |
| :--: | ------------------------------------------------------------ |
|      |                                                              |

| Trie | ▪ 前缀树▪ 后缀树▪ 基数树 |
| :--: | ------------------------ |
|      |                          |

| 空间划分树 | ▪ [四叉树](http://baike.baidu.com/view/2063378.htm)▪ [八叉树](http://baike.baidu.com/view/1035343.htm)▪ [k-d树](http://baike.baidu.com/view/8668561.htm)▪ [vp-树](http://baike.baidu.com/searchword/?word=vp-树&pic=1&sug=1&enc=utf8)▪ [R树](http://baike.baidu.com/view/906563.htm)▪ [R*树](http://baike.baidu.com/searchword/?word=R*树&pic=1&sug=1&enc=utf8)▪ [R+树](http://baike.baidu.com/searchword/?word=R%2B树&pic=1&sug=1&enc=utf8)▪ [X树](http://baike.baidu.com/searchword/?word=X树&pic=1&sug=1&enc=utf8)▪ [M树](http://baike.baidu.com/searchword/?word=M树&pic=1&sug=1&enc=utf8)▪ [线段树](http://baike.baidu.com/view/670683.htm)▪ [希尔伯特R树](http://baike.baidu.com/searchword/?word=希尔伯特R树&pic=1&sug=1&enc=utf8)▪ [优先R树](http://baike.baidu.com/searchword/?word=优先R树&pic=1&sug=1&enc=utf8) |
| :--------: | ------------------------------------------------------------ |
|            |                                                              |

| 非二叉树 | ▪ [Exponential tree](http://baike.baidu.com/searchword/?word=Exponential tree&pic=1&sug=1&enc=utf8)▪ [Fusion tree](http://baike.baidu.com/searchword/?word=Fusion tree&pic=1&sug=1&enc=utf8)▪ [区间树](http://baike.baidu.com/searchword/?word=区间树&pic=1&sug=1&enc=utf8)▪ [PQ tree](http://baike.baidu.com/searchword/?word=PQ tree&pic=1&sug=1&enc=utf8)▪ [Range tree](http://baike.baidu.com/searchword/?word=Range tree&pic=1&sug=1&enc=utf8)▪ [SPQR tree](http://baike.baidu.com/searchword/?word=SPQR tree&pic=1&sug=1&enc=utf8)▪ [Van Emde Boas tree](http://baike.baidu.com/searchword/?word=Van Emde Boas tree&pic=1&sug=1&enc=utf8) |
| :------: | ------------------------------------------------------------ |
|          |                                                              |

| 其他类型 | ▪ [堆](http://baike.baidu.com/view/249120.htm)▪ [散列树](http://baike.baidu.com/searchword/?word=散列树&pic=1&sug=1&enc=utf8)▪ [Finger tree](http://baike.baidu.com/searchword/?word=Finger tree&pic=1&sug=1&enc=utf8)▪ [Metric tree](http://baike.baidu.com/searchword/?word=Metric tree&pic=1&sug=1&enc=utf8)▪ [Cover tree](http://baike.baidu.com/searchword/?word=Cover tree&pic=1&sug=1&enc=utf8)▪ [BK-tree](http://baike.baidu.com/searchword/?word=BK-tree&pic=1&sug=1&enc=utf8)▪ [Doubly-chained tree](http://baike.baidu.com/searchword/?word=Doubly-chained tree&pic=1&sug=1&enc=utf8)▪ [iDistance](http://baike.baidu.com/searchword/?word=iDistance&pic=1&sug=1&enc=utf8)▪ [Link-cut tree](http://baike.baidu.com/searchword/?word=Link-cut tree&pic=1&sug=1&enc=utf8)▪ [树状数组](http://baike.baidu.com/view/1420784.htm) |
| :------: | ------------------------------------------------------------ |
|          |                                                              |